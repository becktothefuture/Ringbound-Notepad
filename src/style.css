/* =====================================================
   ROOT THEME VARIABLES
   ===================================================== */
:root {
  /* Browser Theme Variables */
  --browser-color: #ffffff; /* Will be set by JS to match browser */
  --browser-text: #202124;
  --browser-text-secondary: #5f6368;
  --browser-button-fill: #ffffff;
  --browser-button-outline: #dadce0;
  --browser-button-text: #202124;
  --browser-spine: #f1f3f4;
  --browser-commentary-bg: rgba(255, 255, 255, 0.95);
  --browser-commentary-text: rgba(32, 33, 36, 0.8);

  /* Theme Transitions */
  --theme-transition: background-color 0.3s ease, color 0.3s ease, border-color 0.3s ease;

  /* Notepad dimensions and spacing */
  --notepad-bg: var(--browser-color);
  --page-bg: var(--browser-color);
  --page-radius: .5rem;

  /* Typography */
  --font-family: 'Uncut Sans', system-ui, sans-serif;
  
  /* Shadow System Variables */
  --shadow-layers: 3;
  --shadow-color: rgba(0, 0, 0, 0.2);
  --shadow-blur: 15px;
  --shadow-spread: 0px;
  --shadow-x-offset: 0px;
  --shadow-y-offset: 2px;
  --shadow-transition: transform 0.2s ease-out;
  
  /* Page rotation origin */
  --page-rotation-origin-x: 50%;
  --page-rotation-origin-y: 5%;
}

/* Theme Transition Class */
:root.theme-transitioning * {
  transition: var(--theme-transition);
}

/* Base Theme Styles */
body {
  background-color: var(--browser-color);
  color: var(--browser-text);
  transition: var(--theme-transition);
}

/* Theme-aware UI Elements */
.homepage-btn {
  background-color: var(--browser-button-fill);
  border-color: var(--browser-button-outline);
  color: var(--browser-button-text);
  transition: var(--theme-transition);
}

.homepage-btn:hover, .homepage-btn:focus {
  background-color: var(--browser-button-outline);
  border-color: var(--browser-button-outline);
  color: var(--browser-text);
}

.notebook-spine {
  background: linear-gradient(180deg, var(--browser-spine) 70%, var(--browser-button-outline) 100%);
  transition: var(--theme-transition);
}

.commentary-overlay {
  background: var(--browser-commentary-bg);
  color: var(--browser-commentary-text);
  transition: var(--theme-transition);
}

h1, h2 {
  color: var(--browser-text);
  transition: var(--theme-transition);
}

.page-tab {
  position: absolute;
  z-index: 1001;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  font-family: var(--font-family);
  font-weight: 600;
  color: transparent !important;
  text-align: center;
  transition: transform 0.2s ease-out;
  background: #fff;
  pointer-events: auto;
  /* Prevent shadow effects */
  --shadow-overlay: 0 !important;
  --shadow-blur: 0 !important;
  --shadow-color: transparent !important;
  filter: none !important;
  opacity: 1 !important;
  /* Ensure tab is not affected by page shadow */
  isolation: isolate;
}

/* Ensure tab content is not affected by shadows */
.page-tab svg {
  filter: none !important;
  opacity: 1 !important;
  isolation: isolate;
}

/* Prevent page shadow from affecting tabs */
.page-tab::after {
  display: none !important;
}

/* =====================================================
   GLOBAL RESET AND BASE STYLES
   ===================================================== */
body, html {
  height: 100%;
  margin: 0;
  padding: 0;
  overflow: hidden;
  background-color: var(--browser-color);
  color: var(--browser-text);
  font-family: 'Inter', system-ui, -apple-system, sans-serif;
  overflow-x: hidden;
  transition: background-color 0.3s ease;
}

body {
  font-size: 14px;
  min-height: 100svh;
  width: 100vw;
  display: flex;
  align-items: center;
  justify-content: center;
}

main {
  position: relative;
  width: 100vw;
  height: 100vh;
  display: flex;
  align-items: flex-end;
  justify-content: center;
  padding-bottom: 5vh;
  box-sizing: border-box;
  overflow: hidden;
  perspective: 1400px; /* enable 3D context for children */
  perspective-origin: 50% 50%;
}

/* =====================================================
   MAIN NOTEPAD CONTAINER
   ===================================================== */
#notepad {
  position: relative;
  width: 50vw;
  max-width: 1100px;
  height: auto;
  aspect-ratio: 16/9;
  display: flex;
  align-items: flex-start;
  justify-content: center;
  z-index: 1000;
  perspective-origin: 50% 50%;
  transform-style: preserve-3d;
  overflow: visible;
  margin: auto;
  top: 0; left: 0; bottom: 0; right: 0;
  
  /* Shadow system configuration */
  --shadow-layers: 5;           /* Number of shadow layers */
  --shadow-color: 0, 0, 0;     /* Shadow RGB color */
  --shadow-opacity: 0.35;      /* Base opacity for shadows */
  --shadow-spread: 12px;       /* Base spread distance */
  --shadow-blur: 28px;         /* Base blur amount */
  --shadow-offset-y: 60px;     /* Vertical offset */
  --shadow-anim-duration: 0.3s; /* Shadow movement animation duration */
  transition: transform 0.35s cubic-bezier(0.4, 0, 0.2, 1);
  transform-origin: center center;
}

#notepad-inner {
  width: 100%;
  height: 100%;
  transform-style: preserve-3d;
}


/* =====================================================
   INDIVIDUAL PAGE STYLING
   ===================================================== */
.page {
  position: absolute;
  top: 0;
  left: 0; 
  width: 100%;
  height: 100%;
  aspect-ratio: 16/9;
  z-index: 2;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  transform-origin: var(--page-rotation-origin-x) var(--page-rotation-origin-y);
  transform-style: preserve-3d;
  overflow: visible;
  --shadow-overlay: 0;
  backface-visibility: visible;
  -webkit-backface-visibility: visible;
}

/* Commentary layer */
.commentary {
  position: absolute;
  bottom: 4rem;
  width: 100%;
  text-align: center;
  font-style: italic;
  pointer-events: none;
  color: var(--browser-text-secondary);
  font-size: 0.9rem;
  text-shadow: 0 1px 2px var(--browser-button-outline);
  z-index: 101;
  transform: translateZ(0.2px);
}

/* =====================================================
   PAGE CONTENT
   ===================================================== */
.page-content {
  position: relative;
  width: 100%;
  height: 100%;
  z-index: 100;
  transform: translateZ(0.1px);
  overflow: hidden;
  will-change: opacity, transform;
  transform-style: preserve-3d;
  padding: 1vh;
  box-sizing: border-box;
  border-radius: 0.5rem;
  background: var(--browser-color) !important;
}

.page-content__inner{
  outline:1px solid var(--browser-button-outline);
  outline-offset:-2px; /* keeps border inside */
  box-sizing:border-box;
  background: var(--browser-color) !important;
  backface-visibility: hidden;
  -webkit-backface-visibility: hidden;
}

/* =====================================================
   PAGE PSEUDO-ELEMENTS (BACKFACE & SHADOW)
   ===================================================== */
/* Inner shadow */
.page::after {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: var(--shadow-color, linear-gradient(to bottom, rgba(0, 0, 0, 1), rgba(0, 0, 0, 0.5)));
  z-index: 300; /* above .page-content so inner shadow overlays content */
  pointer-events: none;
  backface-visibility: hidden;
  opacity: var(--shadow-overlay, 0);
  filter: blur(var(--shadow-blur, 0px));
  transform: translateZ(1px);

}

/* Topmost page should have no inner shadow */
.page:first-child {
  --shadow-overlay: 0;
}

/* =====================================================
   CHAPTER TAB STYLES
   ===================================================== */
.page-tab {
  position: absolute;
  z-index: 1001;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  font-family: var(--font-family);
  font-weight: 600;
  color: transparent !important;
  text-align: center;
  transition: transform 0.2s ease-out;
  background: #fff;
  pointer-events: auto;
  /* Prevent shadow effects */
  --shadow-overlay: 0 !important;
  --shadow-blur: 0 !important;
  --shadow-color: transparent !important;
  filter: none !important;
  opacity: 1 !important;
}

/*
  SHADOW LAYER: Simple, flat, always behind the notebook
  Absolutely centered, no 3D transforms, matches notebook size
*/
.notebook__shadow {
  position: absolute;
  width: 100%;
  height: 100%;
  aspect-ratio: 16/11;
  pointer-events: none;
  z-index: 0; /* below notebook, above body */
  box-sizing: border-box;
  box-shadow: 
    0px 10px 15px -3px hsla(0, 5%, 0%, 0.1),
    0px 30px 30px -10px hsla(0, 5%, 0%, 0.15),
    0px 60px 50px -15px hsla(0, 5%, 0%, 0.2),
    0px 100px 80px -20px hsla(0, 5%, 0%, 0.25),
    0px 150px 120px -30px hsla(0, 5%, 0%, 0.3);
  /* Softer shadow with display-p3 color space for wider gamut displays */
  box-shadow:
    0px 10px 15px -3px color(display-p3 0.013 0.013 0.013 / 0.1),
    0px 30px 30px -10px color(display-p3 0.013 0.013 0.013 / 0.15), 
    0px 60px 50px -15px color(display-p3 0.013 0.013 0.013 / 0.2),
    0px 100px 80px -20px color(display-p3 0.013 0.013 0.013 / 0.25),
    0px 150px 120px -30px color(display-p3 0.013 0.013 0.013 / 0.3);
}



/* Visual indicator for Z-rotation testing (JS toggles this class) */
/* .notepad--z-rotating {
  border: 3px solid red !important;
} */

.notebook {
  transform-style: preserve-3d;
  position: relative;
}

.notebook__layered-shadow {
  position: absolute;
  inset: -20px;  /* Expand beyond notebook edges */
  pointer-events: none;  /* Don't interfere with interaction */
  transform-style: preserve-3d;
  /* First shadow layer (closest) */
  box-shadow:
    calc(var(--shadow-x-offset)) var(--shadow-y-offset) var(--shadow-blur) var(--shadow-spread) var(--shadow-color),
    /* Second shadow layer (middle distance) */
    calc(var(--shadow-x-offset) * 1.5) calc(var(--shadow-y-offset) * 2) calc(var(--shadow-blur) * 2) calc(var(--shadow-spread) * 2) var(--shadow-color),
    /* Third shadow layer (furthest) */
    calc(var(--shadow-x-offset) * 2) calc(var(--shadow-y-offset) * 3) calc(var(--shadow-blur) * 3) calc(var(--shadow-spread) * 3) var(--shadow-color);
  transition: var(--shadow-transition);
  will-change: transform;  /* Hint for browser optimization */
}

/* =====================================================
   (Add any utility/debug styles below as needed)
   ===================================================== */

/* ================= HOMEPAGE OVERLAY STYLES ================= */
#homepage-overlay {
  position: absolute;
  top: 0;
  left: 0;
  width: 100vw;
  height: 100vh;
  z-index: 100;
  pointer-events: none;
}

.homepage-titles {
  position: absolute;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  gap: .25em;
  top: 5vh;
  left: 50%;
  transform: translateX(-50%);
  text-align: center;
  width: 100vw;
  pointer-events: none;
}

h1, h2 {
  font-family: var(--font-family);
  font-size: 1.1em;
  font-weight: 600;
  color: #1e1e1e;
  margin: 0;
  padding: 0;
  letter-spacing: 0.04em;
  text-transform: uppercase;
}




.homepage-logo {
  position: absolute;
  left: 50%;
  bottom: 4vh;
  transform: translate(-50%, -50%);
  width: 64px;
  height: 40px;
  pointer-events: none;
}

.homepage-logo svg {
  width: 100%;
  height: 100%;
  opacity: 0.10;
  display: block;
}

.homepage-buttons {
  position: absolute;
  top: calc(50% + 22vh);
  left: 50%;
  transform: translateX(-50%);
  display: flex;
  gap: 1.5rem;
  pointer-events: auto;
}

.homepage-btn {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  border-radius: 1000px;
  border: 1px solid var(--browser-button-outline);
  font-family: var(--font-family);
  font-size: 0.75em;
  font-weight: 600;
  color: var(--browser-button-text);
  text-transform: uppercase;
  text-wrap: nowrap;
  letter-spacing: 0.04em;
  text-decoration: none;
  transition: background 0.1s, color 0.2s, border 0.1s;
  cursor: pointer;
  pointer-events: auto;
  padding: 0.75rem 2.5rem;
  background-color: var(--browser-button-fill);
}

.homepage-btn:hover, .homepage-btn:focus {
  background: var(--browser-button-outline);
  border: 1px solid var(--browser-button-outline);
  color: var(--browser-text);
}

/* Remove video background styles */
#video-bg {
  display: none;
}


@media (max-width: 390px) {
  .homepage-buttons { flex-direction: column; }
}



@font-face {
  font-family: 'Uncut Sans';
  src: url('./assets/fonts/UncutSans-Regular.woff2') format('woff2'),
       url('./assets/fonts/UncutSans-Regular.woff') format('woff'),
       url('./assets/fonts/UncutSans-Regular.otf') format('opentype');
  font-weight: 400;
  font-style: normal;
  font-display: swap;
}
@font-face {
  font-family: 'Uncut Sans';
  src: url('./assets/fonts/UncutSans-Medium.woff2') format('woff2'),
       url('./assets/fonts/UncutSans-Medium.woff') format('woff');
  font-weight: 500;
  font-style: normal;
  font-display: swap;
}
@font-face {
  font-family: 'Uncut Sans';
  src: url('./assets/fonts/UncutSans-Light.otf') format('opentype');
  font-weight: 300;
  font-style: normal;
  font-display: swap;
}
@font-face {
  font-family: 'Uncut Sans';
  src: url('./assets/fonts/UncutSans-LightItalic.otf') format('opentype');
  font-weight: 300;
  font-style: italic;
  font-display: swap;
}

body, * {
  font-family: 'Uncut Sans', system-ui, sans-serif !important;
}

/* Zoomed-in state toggled by JS */
#notepad.notepad--zoomed {
  transform: scale(2);
}

/* Overlay zoom-out and blur effect when notebook is zoomed in */
#homepage-overlay.overlay--zoomed-out {
  transform: scale(1.38);
  filter: blur(6px) brightness(0.95);
  transition: transform 0.35s cubic-bezier(0.4, 0, 0.2, 1), filter 0.35s cubic-bezier(0.4, 0, 0.2, 1);
  pointer-events: none;
}

/* Ensure overlay transitions back smoothly */
#homepage-overlay {
  transition: transform 0.35s cubic-bezier(0.4, 0, 0.2, 1), filter 0.35s cubic-bezier(0.4, 0, 0.2, 1);
}

.notebook-spine {
  position: absolute;
  top: -8px;
  left: 0;
  width: 100%;
  height: 8px;
  background: linear-gradient(180deg, var(--browser-spine) 70%, var(--browser-button-outline) 100%);
  z-index: 20;
  box-shadow: 0 2px 8px 0 rgba(0,0,0,0.18);
  pointer-events: none;
  /* Slight 3D effect for realism */
  transform: translateZ(2px);
}

/* =====================================================
   COMMENTARY OVERLAY
   ===================================================== */
.commentary-overlay {
  position: fixed;
  bottom: 2rem;
  left: 50%;
  transform: translateX(-50%);
  width: 80%;
  max-width: 800px;
  text-align: center;
  font-family: var(--font-family);
  font-size: 1.1rem;
  line-height: 1.5;
  color: var(--browser-commentary-text);
  padding: 1.5rem;
  background: var(--browser-commentary-bg);
  border-radius: 8px;
  box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
  backdrop-filter: blur(8px);
  -webkit-backdrop-filter: blur(8px);
  z-index: 1000;
  pointer-events: none;
  transition: opacity 0.3s ease, transform 0.3s ease;
  opacity: 0;
  transform: translate(-50%, 20px);
}

.commentary-overlay.visible {
  opacity: 1;
  transform: translate(-50%, 0);
}

/* Ensure the overlay is above the notebook but below any UI elements */
#notepad {
  z-index: 100;
}

/* Ensure the overlay is visible on all devices */
@media (max-width: 768px) {
  .commentary-overlay {
    width: 90%;
    font-size: 1rem;
    padding: 1rem;
    bottom: 1rem;
  }
}
